## Stand Alone Prompts

Prompts that the agent execute - follow the instructions which promts to be executed. If nothing provided - execute only one prompt - the first not executed and stop. When a given prompt is executed, the checkbox infront of it should be marked. Changing the checkbox to `- [x]` is **the only change you are allowed to do**. Never change anything else than marking a checkbox! 

 - [x] [P01] Analyze the scripts `.rdd/scripts/archive.sh`, `.rdd/scripts/clarify-changes.sh`, `.rdd/scripts/create-change.sh`, `.rdd/scripts/delete-branch.sh`, `.rdd/scripts/delete-merged-branches.sh`, `.rdd/scripts/fix-management.sh`, `.rdd/scripts/general.sh`. Your task is to create a plan in form of markdown `.rdd-docs/workspace/scripts-refactor-implementation-plan.md` for achieving of the following:
    - To be created a single wrapper script which should call the rest of the scripts. Only this wrapper script should be used in the future. Name: `.rdd/scripts/rdd.sh`
    - Propose an approach to be regrouped the functionality of the scripts above to series of helper scripts, each of which with specific focus and specific scope
    - The plan should be in form of prompts - using as example the template file `.rdd/templates/journal.md`
    - All the functionality from the listed above scripts should be represented in the new scripts
    - There should be no redundancy in the newly created scripts
  
 - [x] [P02] **[R001] Create core-utils.sh** - Implement the foundational utility script as detailed in `.rdd-docs/workspace/implementation-plan.md` section "Phase 1: Foundation and Utilities → [R001]". Create or replace `.rdd/scripts/core-utils.sh` and implement: (1) Colored output functions: print_success(), print_error(), print_warning(), print_info(), print_step(), print_banner() - extract color codes and formatting from existing scripts; (2) Validation functions: validate_name() for kebab-case validation with max 5 words, validate_branch_name(), validate_file_exists(); (3) Configuration functions: get_config(), set_config() for reading/writing settings; (4) Error handling utilities for consistent error management; (5) Help message generation functions. Ensure all functions are exportable and include inline documentation. Reference the "Helper Scripts Organization → 9. core-utils.sh" section for the complete function list and responsibilities.

 - [x] [P03] **[R002] Create git-utils.sh** - Implement git operations utility script as detailed in `.rdd-docs/workspace/scripts-refactor-implementation-plan.md` section "Phase 1 → [R002]". Create `.rdd/scripts/git-utils.sh` and source core-utils.sh. Implement: (1) check_git_repo() to verify git repository; (2) check_uncommitted_changes() to detect modified/staged/untracked files; (3) get_default_branch() to return 'main' or 'master'; (4) fetch_main() to fetch latest from remote; (5) compare_with_main() showing commit differences and file changes; (6) get_modified_files() listing changed files with status indicators; (7) get_file_diff(file_path) for specific file diffs; (8) push_to_remote(branch_name) with upstream tracking; (9) auto_commit(message) to stage and commit. Extract these functions from archive.sh, delete-branch.sh, general.sh, and fix-management.sh. Reference "Helper Scripts Organization → 8. git-utils.sh" for detailed specifications.
 
 - [x] [P04] **[R003] Create workspace-utils.sh** - Implement workspace management script as detailed in `.rdd-docs/workspace/scripts-refactor-implementation-plan.md` section "Phase 2: Core Management Scripts → [R003]". Create `.rdd/scripts/workspace-utils.sh` and source core-utils.sh and git-utils.sh. Implement: (1) init_workspace(type) where type='change' or 'fix' to initialize with templates; (2) archive_workspace(branch_name, keep_workspace) to copy to `.rdd-docs/archive/{branch-folder}` with metadata (archivedAt, branch, archivedBy, lastCommit); (3) backup_workspace() to `.rdd-docs/workspace/.backups/{timestamp}`; (4) restore_workspace() from latest backup; (5) clear_workspace() with safety confirmation; (6) copy_template(template_name, destination) with validation. Extract functionality from archive.sh, clarify-changes.sh, create-change.sh, and fix-management.sh. Reference "Helper Scripts Organization → 2. workspace-utils.sh" section and "Current State Analysis" for existing implementations.

 - [x] [P05] **[R004] Create branch-utils.sh** - Implement branch management script as detailed in `.rdd-docs/workspace/implementation-plan.md` section "Phase 2 → [R004]". Create `.rdd/scripts/branch-utils.sh` and source core-utils.sh and git-utils.sh. Implement: (1) create_branch(branch_type, branch_name) for 'feat'/'fix' with format validation; (2) delete_branch(branch_name, force, skip_checks) with safety checks for uncommitted changes and merge status; (3) delete_merged_branches() for batch deletion with confirmation; (4) check_merge_status(branch_name, base_branch) to verify merge state; (5) list_branches(filter) with optional filtering. Extract and consolidate functionality from create-change.sh (branch creation), delete-branch.sh (complete deletion logic), delete-merged-branches.sh (batch operations), and fix-management.sh (branch creation). Reference "Helper Scripts Organization → 1. branch-utils.sh" and existing script implementations in "Current State Analysis".

 - [x] [P06] **[R005] Create requirements-utils.sh** - Implement requirements management script as detailed in `.rdd-docs/workspace/scripts-refactor-implementation-plan.md` section "Phase 2 → [R005]". Create `.rdd/scripts/requirements-utils.sh` and source core-utils.sh and git-utils.sh. Implement: (1) validate_requirements(file_path) to check [ADDED|MODIFIED|DELETED] format; (2) get_next_id(prefix, file_path) for auto-assigning FR-01, NFR-01, etc.; (3) track_id_mapping(old_id, new_id, mapping_file) to log ID changes; (4) merge_requirements(dry_run, create_backup) to process ADDED (assign IDs), MODIFIED (update), DELETED (flag for review); (5) preview_merge() showing counts and changes; (6) analyze_requirements_impact() comparing with main branch. Extract from clarify-changes.sh (validation) and general.sh (merge/preview/ID management). Reference "Helper Scripts Organization → 3. requirements-utils.sh" and "Functional Grouping Analysis → 3. Requirements Management" for complete specifications.

 - [x] [P07] **[R006] Create clarify-utils.sh** - Implement clarification management script as detailed in `.rdd-docs/workspace/scripts-refactor-implementation-plan.md` section "Phase 3: Workflow Scripts → [R006]". Create `.rdd/scripts/clarify-utils.sh` and source core-utils.sh and workspace-utils.sh. Implement: (1) init_clarification() to create open-questions.md, copy clarity-taxonomy.md, initialize clarification-log.jsonl; (2) log_clarification(question, answer, answered_by, session_id) to append valid JSONL entries with proper escaping; (3) create_open_questions_template() with status legend and structure; (4) copy_taxonomy() from `.rdd-docs/clarity-taxonomy.md` with validation. Extract from clarify-changes.sh (init/log/taxonomy functions) and create-change.sh (clarification initialization). Reference "Helper Scripts Organization → 5. clarify-utils.sh" and ensure JSONL format compliance as specified in acceptance criteria.

 - [x] [P08] **[R007] Create prompt-utils.sh** - Implement prompt management script as detailed in `.rdd-docs/workspace/scripts-refactor-implementation-plan.md` section "Phase 3 → [R007]". Create `.rdd/scripts/prompt-utils.sh` and source core-utils.sh. Implement: (1) mark_prompt_completed(prompt_id, journal_file) to change checkbox `- [ ]` to `- [x]` using sed, modifying ONLY the checkbox; (2) log_prompt_execution(prompt_id, execution_details, session_id) to append JSONL to `.rdd-docs/workspace/log.jsonl` with timestamp, promptId, executionDetails (escaped), sessionId; (3) list_prompts(status) to filter by 'unchecked'/'checked'/'all'; (4) validate_prompt_status(prompt_id, journal_file) to check existence and status. Extract from fix-management.sh (mark-prompt-completed and log-prompt-execution functions). Reference "Helper Scripts Organization → 6. prompt-utils.sh" and note the JSONL escaping requirements using jq when available.

 - [x] [P09] **[R008] Create pr-utils.sh** - Implement pull request management script as detailed in `.rdd-docs/workspace/scripts-refactor-implementation-plan.md` section "Phase 3 → [R008]". Create `.rdd/scripts/pr-utils.sh` and source core-utils.sh and git-utils.sh. Implement: (1) create_pr(branch_name, title, body, draft) using GitHub CLI `gh pr create` with availability check; (2) update_pr(pr_number, updates) to modify existing PR; (3) request_review(pr_number, reviewers) to request GitHub reviews; (4) pr_workflow(branch_name, archive_path) for automated PR creation with standard format (title: "feat/fix: {name} wrap-up", body with branch and archive info). Extract from fix-management.sh (PR creation logic). Reference "Helper Scripts Organization → 7. pr-utils.sh" and ensure graceful degradation when GitHub CLI is unavailable as specified in acceptance criteria.

 - [x] [P10] **[R009] Create change-utils.sh** - Implement change workflow script as detailed in `.rdd-docs/workspace/scripts-refactor-implementation-plan.md` section "Phase 3 → [R009]". Create `.rdd/scripts/change-utils.sh` and source core-utils.sh, git-utils.sh, branch-utils.sh, workspace-utils.sh, clarify-utils.sh. Implement: (1) create_change(change_name, change_type) orchestrating complete workflow - validate name, generate change ID (YYYYMMDD-HHmm format), create branch, initialize workspace; (2) init_change_tracking(change_id, branch_name, change_type) to create clarification-log.jsonl, open-questions.md, requirements-changes.md; (3) create_change_config(config_data) to write `.rdd-docs/workspace/.current-change` JSON with all required fields; (4) wrap_up_change() executing archive, commit, push, PR creation. Extract from create-change.sh (complete workflow) and fix-management.sh (wrap-up). Reference "Helper Scripts Organization → 4. change-utils.sh" and verify integration with all dependent utility scripts per dependencies listed in [R009].

 - [x] [P10.1] Verify if the scripts `.rdd/scripts/change-utils.sh`, `.rdd/scripts/pr-utils.sh`, `.rdd/scripts/prompt-utils.sh`, `.rdd/scripts/clarify-utils.sh`, `.rdd/scripts/requirements-utils.sh`, `.rdd/scripts/branch-utils.sh`, `.rdd/scripts/workspace-utils.sh`, `.rdd/scripts/git-utils.sh`, `.rdd/scripts/core-utils.sh` are developed accordingly `.rdd-docs/workspace/implementation-plan.md`. Check all current scripts in `.rdd/scripts`. Check for inconsistenies, errors, bugs, problems, repetitions and redundancy. Generate a file `.rdd-docs/workspace/implementation-plan-verification-01.md` with the result.
  
 - [x] [P10.2] Execute implementation plan `.rdd-docs/workspace/implementation-plan-10-2.md`

 - [x] [P11] **[R010] Create rdd.sh wrapper script** - Implement the main wrapper as detailed in `.rdd-docs/workspace/implementation-plan.md` section "Phase 4: Main Wrapper → [R010]". Create `.rdd/scripts/rdd.sh` and source all utility scripts (core-utils.sh, git-utils.sh, workspace-utils.sh, branch-utils.sh, requirements-utils.sh, clarify-utils.sh, prompt-utils.sh, pr-utils.sh, change-utils.sh). Implement domain-based routing for commands in format `rdd.sh <domain> <action> [options]`. Domains: branch, workspace, requirements, change, fix, clarify, prompt, pr, git. Create comprehensive help system organized by domain. Implement command parsing with validation and clear error messages. Add version info and make executable. Map all commands as shown in "Command Structure" section: `rdd.sh branch create` → create_branch(), `rdd.sh workspace archive` → archive_workspace(), etc. Reference complete command structure in [R010] and ensure all acceptance criteria are met including helpful suggestions for unknown commands.

 - [-] [P12] **[R011] Create integration tests** - Implement test script as detailed in `.rdd-docs/workspace/scripts-refactor-implementation-plan.md` section "Phase 5: Testing and Migration → [R011]". Create `.rdd/scripts/test-rdd.sh` to test: (1) Branch creation workflow (feat/fix branches, naming validation); (2) Workspace management (init, archive, backup/restore); (3) Requirements merge (validate, preview, merge with ID assignment); (4) Change/fix creation (end-to-end workflow); (5) Prompt management (mark completed, log execution, list filtering); (6) Git operations (compare, modified files, diffs); (7) Error handling (invalid input, missing files, uncommitted changes, non-git directory). Use temporary test directory for destructive operations. Print clear pass/fail results. Document results in `.rdd/scripts/test-results.md`. Ensure no regression compared to original scripts. Reference acceptance criteria in [R011] for comprehensive test coverage requirements.

 - [x] [P13] **[R012] Create migration guide** - Create migration documentation as detailed in `.rdd-docs/workspace/implementation-plan.md` section "Phase 5 → [R012]". Create `.rdd-docs/workspace/scripts-migration-guide.md` documenting: (1) Complete command mapping showing OLD → NEW for all operations (use the exact mappings provided in "Command Mapping" section of [R012]); (2) Breaking changes identification with migration steps; (3) Migration checklist for users; (4) Troubleshooting section for common issues; (5) Rollback procedure; (6) Side-by-side examples of old vs new commands. Ensure all old script commands have documented equivalents: `./create-change.sh` → `rdd.sh change create`, `./archive.sh` → `rdd.sh workspace archive`, `./.rdd/scripts/fix-management.sh mark-prompt-completed` → `rdd.sh prompt mark-completed`, etc. Reference complete mapping table in [R012] and ensure migration is achievable without data loss per acceptance criteria.

 - [-] [P14] **[R013] Deprecate old scripts** - Complete deprecation and archiving as detailed in `.rdd-docs/workspace/scripts-refactor-implementation-plan.md` section "Phase 5 → [R013]". Tasks: (1) Add prominent deprecation warning to each old script (archive.sh, clarify-changes.sh, create-change.sh, delete-branch.sh, delete-merged-branches.sh, fix-management.sh, general.sh) that prints: "⚠ WARNING: This script is deprecated. Please use: rdd.sh <domain> <action>. See .rdd-docs/migration-guide.md"; (2) Update all documentation (README.md, all .rdd-docs/ files, all .github/prompts/ files) to reference new rdd.sh commands; (3) Create `.rdd/scripts/archive/` directory; (4) Move old scripts to archive with README.md explaining they're for reference only; (5) Set 3-month timeline for final removal; (6) Maintain backward compatibility during transition. Reference acceptance criteria in [R013] ensuring deprecation warnings are clear and all documentation is updated.
 
 - [x] [P15] There is a new scripts organization. Change `.github/prompts/rdd.01-create-change.prompt.md` to use only `.rdd/scripts/rdd.sh` as specified in `.rdd-docs/workspace/scripts-migration-guide.md`
  
 - [x] [P16] Check this github prompt -`.github/prompts/rdd.01-create-change.prompt.md`. Analyze what from the instructions can be done via `.rdd/scripts/rdd.sh` calling some of the *-utils.sh files in `.rdd/scripts`. Write the result of your analysis in file `.rdd-docs/workspace/implementation-plan-P16.md` where in detail should be specified what should be done.
 
 - [x] [P16.1] This prompt is related to [P16] - get acknowledged for it. Change so the banner in S01 step to be displayed by `.rdd/scripts/rdd.sh`, not in the chat. Do not make code changes, but update the analysis in `.rdd-docs/workspace/implementation-plan-P16.md`
  
 - [x] [P16.2] This prompt is related to [P16] and [P16.1] - get acknowledged for it. Change so S03 step to be fully automatedand to use `.rdd/scripts/rdd.sh` - the ask and user input should be handled in the command prompt, not in the chat. Find the best way after this step the copilot to understand what is the user imput as this is needed for the next step. Do not make code changes, but update the analysis in `.rdd-docs/workspace/implementation-plan-P16.md`
  
- [x] [P16.3] This prompt is related to [P16], [P16.1] and [P16.2] - get acknowledged for it. Change so S03 step to be the only step needed to clarify the name. The script should ask for user input and should normalize the input so to be kebab-case - no copilot involvement should be needed here. Find the best way to normalize the name provided from the user. If the name can not be normalized - ask the user for correction.With this the need of S04 should be eliminated - verify and if S04 is not necessary any more - write in the analysis to be removed. Also add step for change the numbering of the steps. Do not make code or prompt changes, but update the analysis in `.rdd-docs/workspace/implementation-plan-P16.md`
  
- [x] [P16.4] Implement the changes accordingly `.rdd-docs/workspace/implementation-plan-P16.md`
  
- [x] [P16.5] This prompt is related to [P16], [P16.1], [P16.0], [P16.4] - get acknowledged for these. And after that check `.github/prompts/rdd.01-create-change.prompt.md` - it become messy and wrong. Fix it.
  
- [x] [P17] Make sure that running `.rdd/scripts/rdd.sh` with option 'rdd.sh change create' or 'rdd.sh change create fix' checks which is the current branch. It should continue its work only if it is in the main branch and the folder `.rdd-docs/workspace` is empty. If not - should notify the user and to exit. This guarantees that it is not executed erroneously while in another branch and with that to modify files and corrupt the current progress in a branch.
  
- [x] [P18] Make sure that running `.rdd/scripts/rdd.sh` with option 'rdd.sh change wrap-up --help' do not execute anything but shows a help on the command. Make sure in general when --help is added as argument to provide help only **whithout any other execution**
  
- [x] [P19] Make sure that running `.rdd/scripts/rdd.sh` with option 'rdd.sh change wrap-up' do not attempt to make a pull request. Pushing to remote is enough - the user should handle manually the pull request.
  
- [x] [P20] Create a new prompt in `.rdd/scripts` named `rdd.01-initiate.prompt.md`. It should simply clarify from the user if it should start feature or fix and to run the respective command from `.rdd/scripts/rdd.sh`. Validate if the new prompt can replace entirely `.github/prompts/rdd.01-create-change.prompt.md` and `.github/prompts/rdd.X1-create.prompt.md`. In case of concerns - stop and create a file `.rdd-docs/workspace/implementation-plan-P20.md` with a questions to the me which I will fulfill later. Still if it is stright forward - create directly without more complications. The prompt should be very consise, small and easy to read, following the best practices for github prompt creation.
   
- [x] [P21] In P20 was created the file `.rdd-docs/workspace/implementation-plan-P20.md` with questions to me. I have updated it with my choices. Read it and see what's my preferences. In case of concerns - stop and create a file `.rdd-docs/workspace/implementation-plan-P21.md` with a questions to the me which I will fulfill later. Still if it is stright forward - create directly without more complications. The prompt should be very consise, small and easy to read, following the best practices for github prompt creation.